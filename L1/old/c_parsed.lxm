1.0e-6=tolsumupper,lower,x1.0xsqrt/return()fxlowerupper,tol,__*sum,piecesi,xdelta_x,end_sum,mid_sum,sum1,pieces=1delta_x=upperlower-()pieces/end_sum=lowerfxupperfx+_*sum=end_sumdelta_x*2.0/mid_sum=0.0pieces=pieces2*sum1=_*sumdelta_x=upperlower-()pieces/i=1ipieces2/<=++ix=lowerdelta_x2.0i*1.0-()*+mid_sum=mid_sumxfx+()for_*sum=end_sum2.0mid_sum*+()delta_x*0.5*()_*sumsum1-fabstol_*sum()*fabs>dowhile()trapezlower=1.0upper=9.0lowerupper,tol,_&sum,trapez()main